<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Jeu du Nombre Mystère</title>
    <link href="output.css" rel="stylesheet">
</head>
<body class="bg-gray-100 min-h-screen flex items-center justify-center p-4">

<main class="bg-white shadow-lg rounded-2xl p-6 w-full max-w-md">
    <h1 class="text-2xl font-bold text-center mb-4 text-blue-800">🎯 Nombre Mystère</h1>

    <!-- Sélecteur de difficulté -->
    <div class="mb-4">
        <label class="block mb-1 font-medium text-gray-700">Difficulté :</label>
        <select id="difficulty" class="w-full px-3 py-2 border rounded-lg">
            <option value="10">Facile (1-10)</option>
            <option value="50">Moyen (1-50)</option>
            <option value="100">Difficile (1-100)</option>
        </select>
    </div>

    <!-- Zone de saisie -->
    <div class="flex gap-2 mb-4">
        <input 
            type="number" 
            id="userresponse"
            placeholder="Entrez un nombre"
            class="flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"
        >
        <button id="btnValidate" class="bg-blue-800 text-white px-4 py-2 rounded-lg hover:bg-blue-900 transition">Valider</button>
    </div>

    <!-- Infos -->
    <p id="essaisRestants" class="text-gray-700 mb-2">Essais restants : <span class="font-bold">5</span></p>

    <!-- Zone d'indices -->
    <div id="indices" class="space-y-2"></div>

    <!-- Historique -->
    <div class="mt-4">
        <h3 class="font-semibold mb-2">📜 Historique</h3>
        <ul id="historique" class="text-sm text-gray-700 space-y-1"></ul>
    </div>

    <!-- Bouton nouvelle partie -->
    <button id="btnRestart" class="hidden mt-4 w-full bg-green-700 text-white py-2 rounded-lg hover:bg-green-800 transition">Nouvelle Partie</button>
</main>

<script>
let nombreAleatoire, essais, max;
const input = document.getElementById("userresponse");
const btnValidate = document.getElementById("btnValidate");
const btnRestart = document.getElementById("btnRestart");
const zoneIndice = document.getElementById("indices");
const essaisRestantsEl = document.getElementById("essaisRestants").querySelector("span");
const historiqueEl = document.getElementById("historique");
const difficulty = document.getElementById("difficulty");

initGame();

// Initialisation du jeu
function initGame() {
    max = Number(difficulty.value);
    nombreAleatoire = Math.floor(Math.random() * max) + 1;
    essais = 5;
    essaisRestantsEl.textContent = essais;
    zoneIndice.innerHTML = "";
    historiqueEl.innerHTML = "";
    input.value = "";
    input.focus();
    btnValidate.disabled = false;
    btnRestart.classList.add("hidden");
    console.log("🔍 Nombre mystère :", nombreAleatoire); // debug
}

// Validation
btnValidate.onclick = () => {
    const val = Number(input.value);
    if (!val || val < 1 || val > max) {
        afficherMessage(`⚠️ Entrez un nombre entre 1 et ${max}`, "bg-yellow-500 border-yellow-700");
        return;
    }

    essais--;
    essaisRestantsEl.textContent = essais;
    historiqueEl.innerHTML += `<li>➡️ ${val}</li>`;

    if (val === nombreAleatoire) {
        afficherMessage("🎉 Bravo, vous avez trouvé !", "bg-green-700 border-green-800");
        finDePartie();
    } else if (essais === 0) {
        afficherMessage(`💀 Perdu ! Le nombre était ${nombreAleatoire}`, "bg-red-700 border-red-800");
        finDePartie();
    } else if (val > nombreAleatoire) {
        afficherMessage("📉 Le nombre mystère est plus petit", "bg-blue-700 border-blue-800");
    } else {
        afficherMessage("📈 Le nombre mystère est plus grand", "bg-blue-700 border-blue-800");
    }

    input.value = "";
    input.focus();
};

// Affiche un message
function afficherMessage(texte, classes) {
    zoneIndice.innerHTML += `
        <div class="mt-2 ${classes} text-white px-4 py-2 rounded-lg">${texte}</div>
    `;
}

// Fin de partie
function finDePartie() {
    btnValidate.disabled = true;
    btnRestart.classList.remove("hidden");
}

// Redémarrage
btnRestart.onclick = initGame;

// Changement de difficulté redémarre la partie
difficulty.onchange = initGame;
</script>

</body>
</html>
